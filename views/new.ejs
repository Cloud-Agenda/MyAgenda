<%- include('partials/header') %>

  <% var _error=typeof error !=='undefined' ? error : null; var _form=typeof form !=='undefined' ? form : {}; %>
    <section class="form card">
      <h2>Nouveau devoir</h2>
      <% if (_error) { %>
        <div class="error" style="color:red; margin-bottom:1em">
          <%= _error %>
        </div>
        <% } %>
          <form action="/events" method="POST" novalidate>
            <label>Titre<br><input name="title" required value="<%= _form.title ? _form.title : '' %>"></label>

            <label>Matière<br>
              <select name="subject" required>
                <option value="">-- Choisir une matière --</option>
                <% const
                  subjects=['Mathématiques','Français','Anglais','Histoire','Géographie','SVT','Physique','Chimie','Informatique','EPS'];
                  %>
                  <% subjects.forEach(function(s){ %>
                    <option value="<%= s %>" <%=(_form.subject===s ? 'selected' : '' ) %>><%= s %>
                    </option>
                    <% }) %>
              </select>
            </label>

            <label>Date<br><input type="date" name="due_date"
                value="<%= _form.due_date ? _form.due_date : '' %>"></label>

            <label>Classe<br>
              <% if (locals.user && locals.user.isAdmin) { %>
                <select name="class" required>
                  <option value="">-- Choisir la classe --</option>
                  <% const classes=['1A','1B','1C','1D','2A','2B','2C','2D','3A','3B','3C','3D','4A','4B','4C','4D']; %>
                    <% classes.forEach(function(c){ %>
                      <option value="<%= c %>" <%=(_form.class===c ? 'selected' : '' ) %>><%= c %>
                      </option>
                      <% }) %>
                </select>
                <% } else { %>
                  <input type="hidden" name="class" value="<%= locals.user.classe %>">
                  <input type="text" value="<%= locals.user.classe %>" disabled
                    style="background-color: #f0f0f0; color: #666;">
                  <% } %>
            </label>

            <label>Pièce jointe (URL)<br><input name="attachment" type="url"
                value="<%= _form.attachment ? _form.attachment : '' %>"></label>
            <label>Description<br><textarea
                name="description"><%= _form.description ? _form.description : '' %></textarea></label>
            <div class="form-actions">
              <button class="button primary" type="submit">Créer</button>
              <a class="button muted" href="/">Annuler</a>
            </div>
          </form>
    </section>

    <%- include('partials/footer') %>